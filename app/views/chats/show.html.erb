<div class="chat-container d-flex flex-column h-100">

  <div id="messages" class="messages-area overflow-y-auto flex-grow-1">
    <% @chat.messages.each do |message| %>
      <% if message.role == "user" %>
        <div class="message-wrapper user-message d-flex justify-content-end mb-4">
          <div class="message-bubble user-bubble px-4 py-3 rounded-4">
            <%= message.content %>
          </div>
        </div>
      <% elsif message.role == "assistant" %>
        <div class="message-wrapper assistant-message d-flex justify-content-start mb-4">
          <div class="message-bubble assistant-bubble px-4 py-3 rounded-4">
            <%= raw(render_markdown(message.content)) rescue simple_format(message.content) %>
          </div>
        </div>
      <% end %>
    <% end %>
  </div>

  <div class="chat-input-container mt-4">
    <%= simple_form_for [@chat, @message], html: { class: 'chat-form' } do |f| %>
      <div class="input-group">
        <%= f.input :content,
            label: false,
            placeholder: "Ask me a recipe...",
            input_html: { class: 'chat-input' },
            wrapper_html: { class: 'flex-grow-1 mb-0' } %>
        <%= f.button :submit,
            "Send",
            class: 'chat-submit-btn' %>
      </div>
    <% end %>
  </div>

</div>
